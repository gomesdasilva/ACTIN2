{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Modifying the indices table\n",
    "\n",
    "In this tutorial we will modify the indices table to include an array of indices with different bandpasses.\n",
    "\n",
    "We will include in the table a modified version of the H$\\alpha$ index using central bandpasses between 1.6 and 2.0 angtroms but the same reference lines as the original."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "from actin2 import ACTIN\n",
    "actin = ACTIN()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The pandas DataFrame table with the activity indices line parameters is in the method `table` inside the class `actin.Indtable`:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ind_id</th>\n",
       "      <th>ind_var</th>\n",
       "      <th>ln_id</th>\n",
       "      <th>ln_c</th>\n",
       "      <th>ln_ctr</th>\n",
       "      <th>ln_win</th>\n",
       "      <th>bandtype</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>L1</td>\n",
       "      <td>CaIIK</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3933.664</td>\n",
       "      <td>1.09</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>L2</td>\n",
       "      <td>CaIIH</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3968.470</td>\n",
       "      <td>1.09</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>R1</td>\n",
       "      <td>CaIIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3901.070</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>R2</td>\n",
       "      <td>CaIIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4001.070</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>L1</td>\n",
       "      <td>NaID1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5895.920</td>\n",
       "      <td>0.50</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>L2</td>\n",
       "      <td>NaID2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5889.950</td>\n",
       "      <td>0.50</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>R1</td>\n",
       "      <td>NaIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5805.000</td>\n",
       "      <td>10.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>R2</td>\n",
       "      <td>NaIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6097.000</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha16</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.60</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha06</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>0.60</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>L1</td>\n",
       "      <td>HeI</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5875.620</td>\n",
       "      <td>0.40</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>R1</td>\n",
       "      <td>HeIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5869.000</td>\n",
       "      <td>5.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>R2</td>\n",
       "      <td>HeIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5881.000</td>\n",
       "      <td>5.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>L1</td>\n",
       "      <td>CaI</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6572.795</td>\n",
       "      <td>0.34</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    ind_id ind_var   ln_id  ln_c    ln_ctr  ln_win bandtype\n",
       "0   I_CaII      L1   CaIIK   1.0  3933.664    1.09      tri\n",
       "1   I_CaII      L2   CaIIH   1.0  3968.470    1.09      tri\n",
       "2   I_CaII      R1  CaIIR1   1.0  3901.070   20.00       sq\n",
       "3   I_CaII      R2  CaIIR2   1.0  4001.070   20.00       sq\n",
       "4    I_NaI      L1   NaID1   1.0  5895.920    0.50       sq\n",
       "5    I_NaI      L2   NaID2   1.0  5889.950    0.50       sq\n",
       "6    I_NaI      R1   NaIR1   1.0  5805.000   10.00       sq\n",
       "7    I_NaI      R2   NaIR2   1.0  6097.000   20.00       sq\n",
       "8   I_Ha16      L1    Ha16   1.0  6562.808    1.60       sq\n",
       "9   I_Ha16      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "10  I_Ha16      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "11  I_Ha06      L1    Ha06   1.0  6562.808    0.60       sq\n",
       "12  I_Ha06      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "13  I_Ha06      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "14   I_HeI      L1     HeI   1.0  5875.620    0.40       sq\n",
       "15   I_HeI      R1   HeIR1   1.0  5869.000    5.00       sq\n",
       "16   I_HeI      R2   HeIR2   1.0  5881.000    5.00       sq\n",
       "17   I_CaI      L1     CaI   1.0  6572.795    0.34      tri\n",
       "18   I_CaI      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "19   I_CaI      R2    HaR2   1.0  6580.310    8.75       sq"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "indtable = actin.IndTable()\n",
    "table = indtable.table\n",
    "\n",
    "table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The columns of the table are as follows:\n",
    "- `ind_id`: The index identification. For the spectral lines to be assigned to an index, their `ind_id` entries must have the same index ID.\n",
    "- `ind_var`: The identification of the line in the index equation: L1, L2, etc, for activity lines (numerator); R1, R2, etc, for reference lines (denominator)\n",
    "- `ln_id`: The spectral line identification.\n",
    "- `ln_c`: Constant to be multiplied to the flux in each line.\n",
    "- `ln_ctr`: Line centre (in angstroms).\n",
    "- `ln_win`: Bandwidth (in angstroms).\n",
    "- `bandtype`: Function used to integrate the flux in the bandpass: 'sq' for square; 'tri' for triangular. If using the triangular bandpass, 'ln_win' will be full-width-half-maximum of the bandpass.\n",
    "\n",
    "So, we will need to give a new index ID to the modified version of the central H$\\alpha$ line and add the H$\\alpha$ reference lines to that index ID.\n",
    "\n",
    "We will add new lines using the `IndTable` function `add_line` which have as arguments the keys in the IndTable.table, i.e., `ind_id`, `ind_var`, `ln_id`, etc.\n",
    "\n",
    "We can get the reference bands parameters using"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "mask = (table.ln_id=='HaR1') & (table.ind_id=='I_Ha16')\n",
    "r1_params = table[mask].to_dict('records')[0]\n",
    "del r1_params['ind_id']\n",
    "\n",
    "mask = (table.ln_id=='HaR2') & (table.ind_id=='I_Ha16')\n",
    "r2_params = table[mask].to_dict('records')[0]\n",
    "del r2_params['ind_id']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We deleted the entries with the `ind_id` because we will give them a new name."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The H$\\alpha$ line centre is:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "ln_ctr = table[table.ln_id=='Ha16'].ln_ctr.values[0]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Now, we create grid of values for the central bandpass "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "pass_grid = np.arange(1.6, 2.1, 0.1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "And finally loop over the values to create the index IDs and lines"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "for i, ln_win in enumerate(pass_grid[:]):\n",
    "\n",
    "    ind_id = f\"I_HaMod{ln_win:.1f}\"\n",
    "    indtable.add_line(ind_id, \"L1\", f\"Ha{ln_win:.1f}\", 1.0, ln_ctr, ln_win, \"sq\")\n",
    "    indtable.add_line(ind_id, **r1_params)\n",
    "    indtable.add_line(ind_id, **r2_params)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The table now includes the new `I_HaMod` indices with the different bandpasses:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ind_id</th>\n",
       "      <th>ind_var</th>\n",
       "      <th>ln_id</th>\n",
       "      <th>ln_c</th>\n",
       "      <th>ln_ctr</th>\n",
       "      <th>ln_win</th>\n",
       "      <th>bandtype</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>L1</td>\n",
       "      <td>CaIIK</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3933.664</td>\n",
       "      <td>1.09</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>L2</td>\n",
       "      <td>CaIIH</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3968.470</td>\n",
       "      <td>1.09</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>R1</td>\n",
       "      <td>CaIIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3901.070</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>I_CaII</td>\n",
       "      <td>R2</td>\n",
       "      <td>CaIIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4001.070</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>L1</td>\n",
       "      <td>NaID1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5895.920</td>\n",
       "      <td>0.50</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>L2</td>\n",
       "      <td>NaID2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5889.950</td>\n",
       "      <td>0.50</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>R1</td>\n",
       "      <td>NaIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5805.000</td>\n",
       "      <td>10.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>I_NaI</td>\n",
       "      <td>R2</td>\n",
       "      <td>NaIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6097.000</td>\n",
       "      <td>20.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha16</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.60</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>I_Ha16</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha06</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>0.60</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>I_Ha06</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>L1</td>\n",
       "      <td>HeI</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5875.620</td>\n",
       "      <td>0.40</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>R1</td>\n",
       "      <td>HeIR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5869.000</td>\n",
       "      <td>5.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>I_HeI</td>\n",
       "      <td>R2</td>\n",
       "      <td>HeIR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5881.000</td>\n",
       "      <td>5.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>L1</td>\n",
       "      <td>CaI</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6572.795</td>\n",
       "      <td>0.34</td>\n",
       "      <td>tri</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>I_CaI</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>I_HaMod1.6</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha1.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.60</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>I_HaMod1.6</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>I_HaMod1.6</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>I_HaMod1.7</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha1.7</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.70</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>I_HaMod1.7</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>I_HaMod1.7</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>I_HaMod1.8</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha1.8</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.80</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>I_HaMod1.8</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>I_HaMod1.8</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>I_HaMod1.9</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha1.9</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>1.90</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>I_HaMod1.9</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>I_HaMod1.9</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>I_HaMod2.0</td>\n",
       "      <td>L1</td>\n",
       "      <td>Ha2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6562.808</td>\n",
       "      <td>2.00</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>I_HaMod2.0</td>\n",
       "      <td>R1</td>\n",
       "      <td>HaR1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6550.870</td>\n",
       "      <td>10.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>I_HaMod2.0</td>\n",
       "      <td>R2</td>\n",
       "      <td>HaR2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>6580.310</td>\n",
       "      <td>8.75</td>\n",
       "      <td>sq</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        ind_id ind_var   ln_id  ln_c    ln_ctr  ln_win bandtype\n",
       "0       I_CaII      L1   CaIIK   1.0  3933.664    1.09      tri\n",
       "1       I_CaII      L2   CaIIH   1.0  3968.470    1.09      tri\n",
       "2       I_CaII      R1  CaIIR1   1.0  3901.070   20.00       sq\n",
       "3       I_CaII      R2  CaIIR2   1.0  4001.070   20.00       sq\n",
       "4        I_NaI      L1   NaID1   1.0  5895.920    0.50       sq\n",
       "5        I_NaI      L2   NaID2   1.0  5889.950    0.50       sq\n",
       "6        I_NaI      R1   NaIR1   1.0  5805.000   10.00       sq\n",
       "7        I_NaI      R2   NaIR2   1.0  6097.000   20.00       sq\n",
       "8       I_Ha16      L1    Ha16   1.0  6562.808    1.60       sq\n",
       "9       I_Ha16      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "10      I_Ha16      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "11      I_Ha06      L1    Ha06   1.0  6562.808    0.60       sq\n",
       "12      I_Ha06      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "13      I_Ha06      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "14       I_HeI      L1     HeI   1.0  5875.620    0.40       sq\n",
       "15       I_HeI      R1   HeIR1   1.0  5869.000    5.00       sq\n",
       "16       I_HeI      R2   HeIR2   1.0  5881.000    5.00       sq\n",
       "17       I_CaI      L1     CaI   1.0  6572.795    0.34      tri\n",
       "18       I_CaI      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "19       I_CaI      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "20  I_HaMod1.6      L1   Ha1.6   1.0  6562.808    1.60       sq\n",
       "21  I_HaMod1.6      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "22  I_HaMod1.6      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "23  I_HaMod1.7      L1   Ha1.7   1.0  6562.808    1.70       sq\n",
       "24  I_HaMod1.7      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "25  I_HaMod1.7      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "26  I_HaMod1.8      L1   Ha1.8   1.0  6562.808    1.80       sq\n",
       "27  I_HaMod1.8      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "28  I_HaMod1.8      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "29  I_HaMod1.9      L1   Ha1.9   1.0  6562.808    1.90       sq\n",
       "30  I_HaMod1.9      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "31  I_HaMod1.9      R2    HaR2   1.0  6580.310    8.75       sq\n",
       "32  I_HaMod2.0      L1   Ha2.0   1.0  6562.808    2.00       sq\n",
       "33  I_HaMod2.0      R1    HaR1   1.0  6550.870   10.75       sq\n",
       "34  I_HaMod2.0      R2    HaR2   1.0  6580.310    8.75       sq"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "indtable.table"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This table can be used as input in `ACTIN` using the option `table_df`.\n",
    "\n",
    "To save the new table as .csv file to the same folder as this file uncomment the lines below:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "#file_path = os.path.join(os.path.dirname(__file__), \"new_indtable.csv\")\n",
    "#indtable.save_table(file_path)"
   ]
  }
 ],
 "metadata": {
  "interpreter": {
   "hash": "398dc28c06ad810e77de546bbdfa897a6ee0b83e59a5207339dda01a7843e01d"
  },
  "kernelspec": {
   "display_name": "Python 3.7.3 64-bit ('base': conda)",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  },
  "orig_nbformat": 4
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
